# Агент для Sparkle-M

Приложение отвечает за сбор данных и их отправку.

## Доступные плагины
1. [Temperature]() - для сбора показателей с датчиков температуры.
2. [PU_Workload]() - для сбора показателей загруженности вычислительных мощностей.

## Зависимости
* `pycryptodome`
* `requests`
* `pycryptodome`

## Запуск
```bash
python3 -m venv venv
# Создание виртуального окружения
source venv/bin/activate
# Активация окружения
pip3 install -r requirements.txt
# запуск
python3 main.py
```
## Документация
### Организация файлов проекта
#### Файловая структура агента:
* `plugins` - каталог пакетов с плагинами.
* `config.py` - модуль для обработки файлов конфигурации и установки плагинов.
* `main.py` - основной код программы.
* `requirements.py` - зависимости.


* `__keygen.py` - код для тестирования функций шифрования и генерации ключа
* `config_example` - пример конфигурации

#### Файловая структура плагина:
* `__init__.py` - содержит импорт нужных для агента функций под нужными(стандартизированными) именами. 
* `manifest.py` - файл манифеста. Содержит информацию о плагине.
* `requirements.txt` - файл со списком зависимостей.
* `server.py` - Код плагина для сервера.
* `main.py` - код модуля (файлов может быть больше, и их имена могут быть любыми).

### Файл конфигурации
Файл конфигурации агента это - tar архив со следующим содержимым:

**config.yaml** 
```yaml
id: 0  # id конфигурации. Должен быть уникальный.
mq_server_address: 172.16.0.2  # Адрес MQ сервера
mq_server_port: 9092  # Порт сервера
send_data_interval: 300  # Интервал отправки данных в секундах
also_store_local: True  # Писать данные локально [Не реализовано на данный момент]
required_plugins:  # Список используемых плагинов (Имена плагинов)
  - "Temperature"
  - "PU_Workload"
```
rsa_key.pub - RSA ключ шифрования
plugins - каталог плагинов для установки